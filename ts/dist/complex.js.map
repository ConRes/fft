{"version":3,"file":"complex.js","sources":["../src/complex.ts"],"sourcesContent":["/// <reference path='./types/types.d.ts' />\n\nimport {round, mround, trunc, diagonal} from './math';\n\nexport const dud = {real: 0, imag: 0};\n\nexport const times = ({real: r1, imag: i1}: ComplexNumber = dud, {real: r2, imag: i2}: ComplexNumber = dud): Complex =>\n  new Complex(r1 * r2 - i1 * i2, r1 * i2 + i1 * r2);\n\nexport const plusTimes = (\n  {real: r1, imag: i1}: ComplexNumber = dud,\n  {real: r2, imag: i2}: ComplexNumber = dud,\n  {real: r3, imag: i3}: ComplexNumber = dud,\n): Complex => new Complex(r1 + (r2 * r3 - i2 * i3), i1 + (r2 * i3 + i2 * r3));\n\nexport const minusTimes = (\n  {real: r1, imag: i1}: ComplexNumber = dud,\n  {real: r2, imag: i2}: ComplexNumber = dud,\n  {real: r3, imag: i3}: ComplexNumber = dud,\n): Complex => new Complex(r1 - (r2 * r3 - i2 * i3), i1 - (r2 * i3 + i2 * r3));\n\nexport const plusTimesSet = (\n  c: Complex,\n  {real: r2, imag: i2}: ComplexNumber = dud,\n  {real: r3, imag: i3}: ComplexNumber = dud,\n): Complex => {\n  const {real: r1, imag: i1}: ComplexNumber = c;\n  const r = (c.real = r1 + (r2 * r3 - i2 * i3)),\n    i = (c.imag = i1 + (r2 * i3 + i2 * r3));\n  c._magnitude2 = magnitude2(r, i);\n  delete c._magnitude;\n  return c;\n};\n\nexport const minusTimesSet = (\n  c: Complex,\n  {real: r2, imag: i2}: ComplexNumber = dud,\n  {real: r3, imag: i3}: ComplexNumber = dud,\n): Complex => {\n  const {real: r1, imag: i1}: ComplexNumber = c;\n  const r = (c.real = r1 - (r2 * r3 - i2 * i3)),\n    i = (c.imag = i1 - (r2 * i3 + i2 * r3));\n  c._magnitude2 = magnitude2(r, i);\n  delete c._magnitude;\n  return c;\n};\n\nexport const magnitude2 = (real?: number, imag?: number) => real * real + imag * imag || 0;\n\n// export const compute = (value: number, compute: (value) => any) => value === 0 ? value : value || compute(value);\n\nexport class Complex implements ComplexNumber {\n  static plusTimes = plusTimes;\n  static minusTimes = minusTimes;\n  static plusTimesSet = plusTimes;\n  static minusTimesSet = minusTimes;\n  static magnitude2 = magnitude2;\n\n  static computeMagnitude2(this: Complex, {_magnitude2 = NaN, real, imag}: Complex = this) {\n    return isNaN(_magnitude2) ? (this._magnitude2 = real * real + imag * imag || 0) : _magnitude2;\n  }\n\n  static computeMagnitude(this: Complex, {_magnitude = NaN, _magnitude2}: Complex = this) {\n    return isNaN(_magnitude) ? (this._magnitude = _magnitude2 ? Math.sqrt(_magnitude2) : 0) : _magnitude;\n  }\n\n  // _real: number; _imaginary: number;\n  _magnitude: number;\n  _magnitude2: number;\n  real: number;\n  imag: number;\n\n  constructor();\n  constructor(real: number, imag?: number);\n  constructor(real?: number, imag?: number) {\n    if (arguments.length > 0) this._magnitude2 = magnitude2((this.real = real), (this.imag = imag || 0));\n  }\n\n  get magnitude2() {\n    return this._magnitude2;\n  }\n  get magnitude() {\n    // @ts-ignore\n    return '_magnitude' in this ? this._magnitude : (this._magnitude = Math.sqrt(this.magnitude2));\n  }\n  plus(z) {\n    return new Complex(this.real + z.real, this.imag + z.imag);\n  }\n  subtract(z) {\n    (this.real = this.real - z.real), (this.imag = this.imag - z.imag);\n  }\n  minus(z) {\n    return new Complex(this.real - z.real, this.imag - z.imag);\n  }\n  times(z: Complex | number) {\n    return typeof z === 'object' ? times(this, z) : new Complex(z * this.real, z * this.imag);\n  } // new Complex(this.real * z.real - this.imag * z.imag, this.real * z.imag + this.imag * z.real)\n\n  getMagnitude() {\n    // const magnitude2 = ;\n    return diagonal(this.real || 0, this.imag || 0); // Math.sqrt(Complex.magnitude2(this.real || 0, this.imag || 0));\n  }\n}\n\nexport default Complex;\n"],"names":[],"mappings":"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"}